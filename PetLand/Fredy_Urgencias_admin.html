<!DOCTYPE html>
<html lang='en'>
<head>
   <meta charset='UTF-8'>
   <meta http-equiv='X-UA-Compatible' content='IE=edge'>
   <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <!-- jQuery -->
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
    <!-- BoostrapJS_01 -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js'></script>
<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We' crossorigin='anonymous'>
    

    <!--iconos-->
    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.8.1/css/all.css' integrity='sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf' crossorigin='anonymous'>
           <!--Poppis-->
   <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
   <!--Relaway-->
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
    <!--Josefin-->
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;1,100;1,200;1,300;1,400;1,500&display=swap" rel="stylesheet">
    <title>PetLand - Admin urgencias</title>
    <link rel="icon" href="IMG/Logo_Web.png">
</head>
<style>

    .Fondo{
      background-color: white;
      background-size: cover;
      background-position: 50% 50%;
      background-repeat: no-repeat;
      background-attachment: fixed;
    }
    .Fondo_header{
      background-image: linear-gradient(150deg, #0000009f 20%, #a07d0b00 100%), url(IMG/Urgencias.jpg);
    }

    .Primer_boton{
      background: #f64c4c;
      color: white;
      border-radius: 0.6rem !important;
    }

    .Primer_boton:hover{
      background: #d63d3d;
      color: white !important;
    }

    .Segundo_Boton{
      background: white;
      border-radius: 0.6rem !important;
    }
    .Segundo_Boton:hover{
      background: rgb(219, 212, 212);
    }

</style>
<body style="padding-top: 4rem;" class="min-vh-100 d-flex flex-column justify-content-between">
   

  <nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand ml-auto" href="#">   
            <div class="d-flex justify-content-center align-items-center m-0">
            <img src="IMG/Logo.ico" width="40" alt="Logo" class="m-0">
            <p class="text-light m-0 ms-2">Petland</p>
            </div>
            </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>    
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-sm-0 ">
          
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="index.html">Inicio</a>
          </li>

          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Servicos
            </a>
            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-center" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="Valentino_tablas.html">Estet. animales&nbsp; <i class="fas fa-cat m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Valentino_citas.html">Citas Estet.&nbsp; <i class="fas fa-plus m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="Jois_servicios.html">Especialidades&nbsp; <i class="fas fa-syringe m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Jois_formulario.html">Citas especiali.&nbsp; <i class="fas fa-plus m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="Axel_Adopciones_Prin.html">Adopciones.&nbsp; <i class="fas fa-paw m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Axel_form_mascota.html">Admin adop.&nbsp; <i class="fas fa-clipboard-list m-0" style="color: rgb(255, 255, 255);"></i></a></li>
            </ul>
          </li>

          <li class="nav-item dropdown">
            <a class="nav-link active  dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Urgencias
            </a>
            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-center" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="Fredy_Pacientes_Urgencia.html">Urg. animales&nbsp; <i class="fas fa-briefcase-medical m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Fredy_Urgencia.html">Citas urg.&nbsp; <i class="fas fa-plus m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="Fredy_Urgencias_admin.html">Admin urg.&nbsp; <i class="fas fa-clipboard-list m-0" style="color: rgb(248, 247, 247);"></i></a></li>
            </ul>
          </li>
          
          <li class="nav-item dropdown">
            <a class="nav-link  dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Acerca de
            </a>
            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-center" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="Victor_veterinarios.html">Nst. personal&nbsp; <i class="fas fa-user-md m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Victor_veterinarios_form.html">Reg. personal&nbsp; <i class="fas fa-plus m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="Angel_Tablas.html">Nst. usuarios&nbsp; <i class="fas fa-users m-0" style="color: rgb(255, 255, 255);"></i></a></li>
              <li><a class="dropdown-item" href="Angel_Registro.html">Reg. usuarios&nbsp; <i class="fas fa-plus m-0" style="color: rgb(255, 255, 255);"></i></a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>


      <div class="container-xxl pt-5 pb-5  Fondo Fondo_header">
          <div class="d-flex flex-column ps-4 pt-3 pb-3" style="width: 55%;">
          <h1 class="text-light mb-4" style="font-family: 'Poppins', sans-serif;  font-weight: 600; font-size: 2.6rem !important;" class="text-light mb-5">Atienda a sus pacientes de manera mas <span style="color: #f64c4c"><strong>ordenada  &nbsp;&nbsp;<i class="fas fa-paw" style="color: white; transform: rotate(50deg);"></i></strong></span></h1>
          <p class="text-light" style="text-align: justify; font-family: 'Josefin Sans', sans-serif; font-weight: 300; font-size: 1rem; padding-bottom: 1.4rem;">Puedes integrar un historial medico de todas las mascotas que atiendes de manera mas dinaminca
            y hacer mas publico el avance entorno al estado de este con su dueño poniendo el estado a activo y proporcionando los datos
            para que este pueda estar al tanto de su mascota en todo momento y poder ver su evolucion entorno a su recuperacion
          </p>
          <div  class="pb-1">
            <a href="#Ver_Tabla_Admin" class="btn  me-4 Primer_boton  botton_ms" id="Solicitudes_ver">Solicitudes</a>
            <a href="Pacientes_Urgencia.html" class="btn  ms-3 Segundo_Boton botton_ms">Ani. internados</a>
          </div>
          </div>
      </div>



      <div class="container-xxl pt-5 pb-5 d-flex justify-content-between align-items-center">
        <img src="IMG/Fondo-Admin.png" alt="" style="width: 35%;" class="mb-1 pt-5 pb-5">
        <div style="width: 40%; text-align: center;" class="me-5">
          <h4 style="color: #f64c4c; font-family: 'Raleway', sans-serif;  font-weight: bold; line-height: 2rem;" class="mb-1 pt-5">¿Como funciona nuestro sistema de citas para administradores?</h4>
          <p style="font-weight: 400; font-family: 'Raleway', sans-serif; font-size: .96rem !important;" class="m-0 mt-4 pb-5" >Todos los usuarios que quieran sacar una cita en urgencias tendran que llenar un formulario de entrada que valida sus datos 
            y los de su mascota, para que despues usted como administrador valide la llegada  de dicho usuaio con la activacion del estado de cita y este pueda ver las ultimas actualizaciones de su mascota
          </p>
        </div>      
      </div>


      
        <div class="container-xxl ps-5 pe-5 pt-5 pb-5 pe-2 ps-2" style="background: #f64c4c;;">
          <h3 class="text-light m-0 mb-4">Funcionalidades de las citas en urgencias:</h3>
          <p class="text-light m-0 pt-2" style="text-align: justify; font-family: 'Josefin Sans', sans-serif; font-weight: 300;">En principio permite tener una mayor organizacion del historial de cada paciente, mostrado a travez un buscador, todas las ocaciones en las que visito al medico, con un resumende de su cituacion medica y los datos de su dueño, teniendo una mayor organizacion entorno a la lista de sus pacientes y saber por adelantado quien planea traer a su mascota para garantizar una atencion mucho mas rapida y agradable.</p>
        </div>


        <!--Dato generales-->

        <div class=" pt-5 pb-2 container">                                          
          <div class="pt-5 pb-5 container">                        
            <div class="d-flex justify-content-between ">
            <div class=" text-light pt-3 pb-3 d-flex justify-content-evenly align-items-center row text-center bg-primary" style=" width: 20%;">
              <i class="fas fa-stream col-4" style="font-size: 3em;"></i>
              <div class="d-flex flex-column justify-content-center align-items-center col-7"><h2 id="Total_num">0</h2> <h5>Total</h5> </div>
            </div>

                <div class="text-light pt-3 pb-3  d-flex justify-content-evenly align-items-center row text-center" style="background: #faac49; width: 20%">
                    <i class="fas fa-question col-4" style="font-size: 3em;"></i>
                    <div class="d-flex flex-column justify-content-center align-items-center col-7"><h2 id="Pendientes_Num">0</h2> <h5>Pendientes</h5> </div>
                </div>
  
                <div class=" text-light pt-3 pb-3 d-flex justify-content-evenly align-items-center row text-center" style="background: #59cf5d; width: 20%">
                    <i class="fas fa-check col-4" style="font-size: 3em;"></i>
                    <div class="d-flex flex-column justify-content-center align-items-center col-7"><h2 id="Activos_num">0</h2> <h5>Activos</h5> </div>        
                </div>
    
                <div class="text-light pt-3 pb-3 d-flex justify-content-evenly align-items-center row text-center" style="background: #ff646c; width: 20%">
                    <i class="fas fa-times col-4" style="font-size: 3em;"></i>
                    <div class="d-flex flex-column justify-content-center align-items-center col-7"><h2 id="Inactivos_num">0</h2> <h5>Inactivos</h5> </div>
                </div>
            </div>
          </div>
      </div>




    <div class="container-xxl pb-0">      
        <div class="container">    
          
          <div class="d-flex row justify-content-between pt-5 pb-5"> 
            <h1 style="font-weight: 300; font-family: 'Josefin Sans', sans-serif;" class="col-12 col-lg-6 m-0">Tabla gestor de citas:</h1>  
         
          <div class="d-flex justify-content-lg-between col-12 col-lg-6">
          <div class="d-flex justify-content-center align-items-center col-12 col-lg-6 form-group "><input type="search" class="form-control" placeholder="Ingrese la cita a buscar" id="Buscar_Citas_Adm"> <div class="input-group-prepend"> <span class="btn btn-success" id="basic-addon1" onclick="Busqueda_Admin()"><i class="fas fa-search"></i></span> </div></div>
          <div class="col-12 col-lg-5" id="Selector_Options"><select class="form-select">
            <option value="Todas las citas" selected>Todas las citas</option>
            <option value="Citas pendientes">Citas pendientes</option>
            <option value="Citas activas">Citas activas</option>
            <option value="Citas inactivas">Citas inactivas</option>
          </select></div>
          </div>

          </div>
          
          
            <table class="table table-light text-center table-hover" id="Ver_Tabla_Admin">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Usuario</th>
                        <th>Telefono</th>                        
                        <th>Mascota</th>
                        <th>Estado de cita</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody id="Tabla_Admin" >
                </tbody>
            </table>


            <!--Mostrar INFO-->
            <button  type="button" class="btn btn-primary d-none" data-bs-toggle="modal" data-bs-target="#miModal" id="Activar_Visor_Adm">Activar Modal</button>
            <button  type="button" class="btn btn-primary d-none" data-bs-toggle="modal" data-bs-target="#miModal_MOD" id="Mostrar_Mod_Adm_boton">Activar Modal</button>
            
            <div id="Mostrar_paciente_Adm">
            </div>

            <div id="Mostrar_Mod_Adm">              
            </div>

            <span class="alert alert-danger" id="Error_Admin_BSQ" style="display: none; "> <strong>¡Error!</strong> Al parecer el usuario al que intenta buscar no existe, procure escribir bien el nombre del usuario para obtener un resultado o simplemente consule al propio cliente su nombre de usuario, para ubicarlo de mejor manera.</span>
            <div class="alert-secondary pt-3 pb-3 ps-4 pe-4 m-0 Alerta_info" style="display: none;" id="Sin_Registros">Hasta el momento <strong> no hay ningun ningun usuario </strong> en espera para urgencias, una vez alguien se registre para este sector su informacion apareca en la tabla, para poder atenderlos de la manera mas rapida posible.</div>
            <div class="alert-secondary pt-3 pb-3 ps-4 pe-4 m-0 Alerta_info" style="display: none;" id="Sin_Pendientes">Al parecer <strong>no hay ningun usuario </strong> con alguna cita pendiente o que falte atender, para ello tendras que esperar el registro de urgencias y activar el estado de cita para iniciar la atencion del paciente.</div>
            <div class="alert-secondary pt-3 pb-3 ps-4 pe-4 m-0 Alerta_info" style="display: none;" id="Sin_Activos">Al parecer <strong>no hay ningun usuario </strong> que tenga una cita activa o que tenga un animal hospitalizado, para ello tendras que esperar a que el usuario acuda a la vaterinaria y activar la cita como valida, para poder proceder</div>
            <div class="alert-secondary pt-3 pb-3 ps-4 pe-4 m-0 Alerta_info" style="display: none;" id="Sin_Inactivos">Al parecer <strong>no hay ningun usuario </strong> que tenga fichada alguna cita o se encuentre inactivo, lo que genera que ningun paciente haiga cancelado ninguna cita por ahora.</div>
        
            <div id="Actualizar" class="w-100 d-flex justify-content-end pb-3 mb-3">
              <button class="btn btn-outline-danger mt-5">Resetear tabla</button>
              </div>

          </div>


          <div class="container-xxl">
            <footer class="text-center row  bg-light ">
              <div class="text-center p-4" style="background-color: rgba(0, 0, 0, 0.05);">
               <strong>Copyright © 2021</strong> Todos los derechos reservados para el Grupo 4
              </div>
            </footer>
          </div>


    </div>




<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js' integrity='sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj' crossorigin='anonymous'></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>

    //Valida si hay un url para lanzar la alerta



function Analizar_cambios(){

    var mi_url = window.location.search
    var Parametros = new URLSearchParams(mi_url)
    var indice = Parametros.get('Cambios')
    var Indice_02 = Parametros.get('Reset')
    

    if(indice != null && indice != ""){      
      

      Swal.fire({
      position: 'center',
      icon: 'success',
      title: 'Los datos se guardaron correctamente',
      text:  `Los datos dentro del perfil de ${indice} se guardaron exitosamente dentro del sistema y tablas `,
      showConfirmButton: true,
      confirmButtonText: "Seguir editando"
    }).then(function (){      
      history.pushState(null, "", "Fredy_Urgencias_admin.html");
      
    })
      
    $(document).ready(
      document.getElementById("Solicitudes_ver").click()
      )  
    }else{
        if(Indice_02 != null && Indice_02 != ""){
      Swal.fire({
      position: 'center',
      icon: 'success',
      title: 'La tabla se reseteo correctamente',
      text:  `Todos los datos de la tabla de urgencia fueron borrados correctamente, ahora podras volver a recibir informacion nueva `,
      showConfirmButton: true,
      confirmButtonText: "Continuar"
    }).then(function (){      
      history.pushState(null, "", "Fredy_Urgencias_admin.html");
      })
      document.getElementById("Solicitudes_ver").click();
    }
}
}
window.onload = Analizar_cambios()



    var Obtener_pacientes = localStorage.getItem("Tablaregistrostorage")
    Obtener_pacientes = JSON.parse(Obtener_pacientes)
    

    if(Obtener_pacientes == null){
    var Obtener_pacientes = []    
    document.getElementById("Sin_Registros").style.display = "block"
    Cantidad_V = 0
    }else{
        Mostar_Pendientes()
        Contar()
    }

    function Contar(){
        var Pendiente = 0
        var Activo = 0
        var Inactivo = 0
        var Cantidad = 0
      for(const A in Obtener_pacientes){
        var Cantidad_stade = JSON.parse(Obtener_pacientes[A])
        if(Cantidad_stade.estado_citar == "Pendiente"){
          Pendiente += 1
          document.getElementById("Pendientes_Num").innerHTML = Pendiente
        }
        if(Cantidad_stade.estado_citar =="Activo"){
          Activo += 1
          document.getElementById("Activos_num").innerHTML = Activo
        }
        if(Cantidad_stade.estado_citar == "Inactivo"){
          Inactivo += 1
          document.getElementById("Inactivos_num").innerHTML = Inactivo
        }
        if(Cantidad_stade.estado_citar != ""){
          Cantidad += 1
          document.getElementById("Total_num").innerHTML = Cantidad 
        }
      }
    }



    function Eliminar_Alertas(){     
      document.getElementById("Sin_Registros").style.display = "none"      
      document.getElementById("Sin_Pendientes").style.display = "none"
      document.getElementById("Sin_Activos").style.display = "none"
      document.getElementById("Sin_Inactivos").style.display = "none"
      
      }


Actualizar_Info()
function Actualizar_Info(){
document.querySelectorAll("#Actualizar button").forEach(e => {
  e.addEventListener('click', () => {
    if(Obtener_pacientes.length == 0){
      Swal.fire({
      position: 'center',
      icon: 'error',
      title: 'No se puede resetear la tabla',
      text:  `Al parecer no se encontro ningun dato en tu tabla asi que no hemos podido proceder a borrarlo `,
      showConfirmButton: true,
      confirmButtonText: "Volver a la tabla"
    })
    }else{
      Swal.fire({
      position: 'center',
      icon: 'question',
      title: '¿Seguro que quieres resetear?',
      text:  `Al aceptar esto todos los datos de esta tablas seran borrados y tambien los datos de las tablas de usuarios. `,      
      showCancelButton: true,
      showConfirmButton: true,
      cancelButtonText: "Cancelar",
      confirmButtonText: "Continuar"
    }).then((result) => {
        if(result.value){          
          localStorage.removeItem("Tablaregistrostorage")
          window.location.replace("Fredy_Urgencias_admin.html?Reset=true")
        }
    })
    }
  })
})
}


//Creo funciones con las tablas personalizada 
function Tablas(Validacion){

      var Imprimir = ""
      Cantidad_V = 0

      for(const i in Obtener_pacientes){

          var Id_USER = parseInt(i)                
          var Ver_Citas = JSON.parse(Obtener_pacientes[i])                
          if(Ver_Citas.estado_citar == Validacion){
          
            Cantidad_V += 1

            Imprimir += "<tr  class='element_Container' id='"+ (Id_USER + 1) +"'>"
            Imprimir += "<td class='align-middle' id='" + Id_USER +"'>" + (Id_USER + 1) + "</td>"
            Imprimir += "<td class='align-middle' id='"+ Ver_Citas.Usuario +"'>" + Ver_Citas.Usuario + "</td>"
            Imprimir += "<td  class='align-middle' id='"+ Ver_Citas.Telefono +"'>" + Ver_Citas.Telefono + "</td>"              
            Imprimir += "<td  class='align-middle' id='"+ Ver_Citas.Nombre_msc +"'>" + Ver_Citas.Nombre_msc + "</td>"
            Imprimir += "<td  class='align-middle' class='' id='"+ Ver_Citas.estado_citar +"'>" + Ver_Citas.estado_citar + "</td>"
            Imprimir += "<td  class='d-flex justify-content-evenly pt-4 pb-4'><button class='btn btn-primary ver_dato_active' id='"+ i +"'>Ver datos</button><button class='Modificar btn btn-success' id='"+ i +"'>Modificar</button></td>" 
            Imprimir  += "</tr>"
          }
          document.getElementById("Tabla_Admin").innerHTML = ""
          document.getElementById("Tabla_Admin").innerHTML = Imprimir
          document.getElementById("Actualizar").innerHTML =  ""                    
          document.getElementById("Actualizar").innerHTML =  ` <button class="btn btn-outline-danger mt-5">Resetear tabla</button>`                    
          Actualizar_Info()
        }        
        return Cantidad_V
}


//Creo funciones con las tablas completas

function Tabla_Completa(){
  var Imprimir = ""
  Cantidad_V = 0
  
      for(const i in Obtener_pacientes){

          var Id_USER = parseInt(i)                
          var Ver_Citas = JSON.parse(Obtener_pacientes[i])                
          
            Cantidad_V += 1
          
            Imprimir += "<tr  class='element_Container' id='"+ (Id_USER + 1) +"'>"
            Imprimir += "<td class='align-middle' id='" + Id_USER +"'>" + (Id_USER + 1) + "</td>"
            Imprimir += "<td class='align-middle' id='"+ Ver_Citas.Usuario +"'>" + Ver_Citas.Usuario + "</td>"
            Imprimir += "<td  class='align-middle' id='"+ Ver_Citas.Telefono +"'>" + Ver_Citas.Telefono + "</td>"              
            Imprimir += "<td  class='align-middle' id='"+ Ver_Citas.Nombre_msc +"'>" + Ver_Citas.Nombre_msc + "</td>"
            Imprimir += "<td  class='align-middle' class='' id='"+ Ver_Citas.estado_citar +"'>" + Ver_Citas.estado_citar + "</td>"
            Imprimir += "<td  class='d-flex justify-content-evenly pt-4 pb-4'><button class='btn btn-primary ver_dato_active' id='"+ i +"'>Ver datos</button><button class='Modificar btn btn-success' id='"+ i +"'>Modificar</button></td>" 
            Imprimir  += "</tr>"
          }
          document.getElementById("Tabla_Admin").innerHTML = ""
          document.getElementById("Tabla_Admin").innerHTML = Imprimir
          document.getElementById("Actualizar").innerHTML =  ""
          document.getElementById("Actualizar").innerHTML =  ` <button class="btn btn-outline-danger mt-5">Resetear tabla</button>`
          Actualizar_Info()
          return Cantidad_V
          
}



    function Mostar_Pendientes(){            
        var Imprimir = ""
        if(Obtener_pacientes.length > 0){            

          
          Tabla_Completa()          
          Addjuntar_Element()
          Eliminar_Alertas()

          if(Cantidad_V == 0){
              document.getElementById("Sin_Registros").style.display = ""
            }

          }
    }

    



    function Addjuntar_Element(){
      

    var Arreglo = document.querySelectorAll("#Tabla_Admin tr button")

    Arreglo.forEach(e =>{
      
      if(e.className == "btn btn-primary ver_dato_active"){
        
        e.addEventListener('click', (elemnto_pr) => {
          Ejecutar_Visor(e.id)
        })
      }
      if(e.className == "Modificar btn btn-success"){
        e.addEventListener('click', (element_Mdf) =>{
            Ejecutar_MOD(e.id)
        })
      }
    })
  }


 



function Info_Adm(Insertar){ 
        var Select_01 = document.getElementById("Estado_Cita").value
        if(Select_01 == "Estad. Cita"){
          Select_01= "Pendiente"
        }  
        var Select_02 = document.getElementById("Est_Salud").value
        if(Select_02 == "Estad. Salud"){
          Select_02 = "Ahun sin definir"
        }

        var Ingresar_New_Date = JSON.parse(Obtener_pacientes[Insertar])
        var Nombre_Mostrar = Ingresar_New_Date.Usuario
      //Pasalor atravez de un string a un array i enviar con el indece, para que actualize los datos
        var Enviar_Adm = JSON.stringify({
        Usuario: Ingresar_New_Date.Usuario,
        contraseña: Ingresar_New_Date.contraseña,
        edad_mascota: Ingresar_New_Date.edad_mascota,
        Fecha_Cita: Ingresar_New_Date.Fecha_Cita,
        Nombre_msc: Ingresar_New_Date.Nombre_msc,
        Telefono: Ingresar_New_Date.Telefono,
        direccion: Ingresar_New_Date.direccion,
        Cituacion: Ingresar_New_Date.Cituacion,
        Especie: Ingresar_New_Date.Especie,
        estado_citar: Select_01,
        EstadoSLD: Select_02, 
        AltaMSC : document.getElementById("Fecha_Cita_S").value,
        Precio : document.getElementById("Precio_Adm").value,
        Cituacion_Medica : document.getElementById("Descrip_Admin").value
      })

      var Uvicar_elemento = JSON.parse(localStorage.getItem("Tablaregistrostorage"))

      var Indice = parseInt(Insertar)
      Uvicar_elemento[Indice] = Enviar_Adm;

      localStorage.setItem("Tablaregistrostorage",JSON.stringify(Uvicar_elemento)) 
      window.location.replace(`Fredy_Urgencias_admin.html?Cambios=${Nombre_Mostrar} `)
}









function Ejecutar_MOD(Elment_MOD){
  
  var Array_Mod = []
  var Seleccionar_Mod = JSON.parse(Obtener_pacientes[Elment_MOD])
  for(const H in Seleccionar_Mod){
    Array_Mod.push(Seleccionar_Mod[H])
  }

  

  document.getElementById("Mostrar_Mod_Adm").innerHTML = `
  <div class="modal fade" id="miModal_MOD" tabindex"-1" aria-hidden="true" aria-labelledby="modalTitle">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content pe-4 ps-4 pt-2">
            <div class="modal-header">
              <h3 class="modal-title" id="modalTitle_Mod" style="font-family: 'Josefin Sans', sans-serif; font-weight: 300">Inserte los datos</h3>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
                <div class="modal-body">



                  <div class="form-row d-flex justify-content-lg-between mb-4 pb-3 pt-3">
                    
                    <div class="form-group col-12 col-lg-5">
                      <label for="Estado_Cita" class="mb-3">Estado de la cita:</label>
                      <select class="form-select" id="Estado_Cita">
                        <option value="Pendiente">Pendiente</option>    
                        <option value="Activo">Activo</option>    
                        <option value="Inactivo">Inactivo</option>    
                      </select>
                    </div>

                    <div class="form-group col-12 col-lg-5">
                      <label for="Est_Salud" class="mb-3">Estado de salud:</label>
                      <select class="form-select" id="Est_Salud">
                        <option value="Estad. Salud">Estad. Salud</option>
                        <option value="Leve">Leve</option>    
                        <option value="Moderado">Moderado</option>    
                        <option value="Grave">Grave</option>    
                      </select>
                    </div>

                  </div>




                  <div class="form-row d-flex justify-content-lg-between mb-4 pb-3">
                    
                    <div class="form-group col-12 col-lg-5">
                      <label class="mb-3">Salida de la mascota:</label>
                      <input type="date" class="form-control" id="Fecha_Cita_S" name="Fecha_Salida" placeholder="Entrada ${Seleccionar_Mod.Fecha_Cita}" value="">
                    </div>
                    <div class="form-group col-12 col-lg-5">
                      <label class="mb-3" for="Precio_Adm">Precio:</label>
                      <input type="number" class="form-control" id="Precio_Adm" placeholder="75">
                    </div>

                  </div>


                  <div class="form-row mb-4">
                    <div class="form-group col-12 col-lg-12">
                      <label for="Descrip_Admin" class="mb-3">Ingrese la cituacion medica:</label>
                      <textarea class="form-control" placeholder="Describa la cituacion y los medicamentos que necesita" style="min-height: 25vh" id="Descrip_Admin"></textarea>
                    </div>  
                  </div>
                  


                       
                </div>
                <div class="modal-footer d-flex justify-content-start">
                      <div>
                        <button class="btn btn-danger me-4" data-bs-dismiss="modal" aria-label="Close">Cancelar</button>  
                      <button class="btn btn-success" onclick="Info_Adm(${Elment_MOD})" id="Guarda_Info">Guardar informacion</button>                      
                      </div>
                    </div>
                </div>
              </div>          
            </div>    
  `
    
    var Inserte = 0
    
    
    for(var u = 9; u < Array_Mod.length; u++){
      if(Array_Mod[u] != "" && Array_Mod[u] != "Pendiente"){
         Inserte += 1        
      }
      
    }
    
    
    if(Inserte > 1){
      $('#modalTitle_Mod').html("Actualize los datos")
      $('#Guarda_Info').html("Actualizar datos")
    }





  var Select_01 = document.getElementById("Estado_Cita")
  var Select_02 = document.getElementById("Est_Salud")
  var Salida_MSC = document.getElementById("Fecha_Cita_S")
  var Precio_Atc = document.getElementById("Precio_Adm")
  var Descripcion_sld = document.getElementById("Descrip_Admin")



if(Seleccionar_Mod.AltaMSC == null || Seleccionar_Mod.AltaMSC == ""){
  Salida_MSC.type = "text"
  
  Salida_MSC.addEventListener('blur', () => {
    Salida_MSC.type = "text"
  })

  Salida_MSC.addEventListener('focus', () => {
    Salida_MSC.type = "date"
  })
}else{
  Salida_MSC.value = Seleccionar_Mod.AltaMSC
}
  
  Select_01.value = Seleccionar_Mod.estado_citar


  if(Seleccionar_Mod.EstadoSLD == "" || Seleccionar_Mod.EstadoSLD == "Ahun sin definir"){
    Select_02.value = "Estad. Salud"
  }else{
    Select_02.value = Seleccionar_Mod.EstadoSLD
  }
  

  Precio_Atc.value = Seleccionar_Mod.Precio

  Descripcion_sld.value = Seleccionar_Mod.Cituacion_Medica





  $('#Mostrar_Mod_Adm_boton').click()
  


}



function Ejecutar_Visor(ID_ELEMENT){
          
          
            var Ver_Citas = JSON.parse(Obtener_pacientes[ID_ELEMENT])

            if(Ver_Citas.estado_citar == "Pendiente"){
              var Stadde = "Sin atender"
            }
            if(Ver_Citas.estado_citar == "Activo"){
              var Stadde = "En atencion"
            }if(Ver_Citas.estado_citar == "Inactivo"){
              var Stadde = "Ya atendido"
            }

            document.getElementById("Mostrar_paciente_Adm").innerHTML =   `
        <div class="modal fade" id="miModal" tabindex"-1" aria-hidden="true" aria-labelledby="modalTitle">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content pe-4 ps-4 pt-2">
            <div class="modal-header">
              <h3 class="modal-title" id="modalTitle" style="font-family: 'Josefin Sans', sans-serif; font-weight: 300">#${Ver_Citas.Usuario}</h3>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
                <div class="modal-body">
                      <div class=" d-flex justify-content-center items-evenly flex-column mb-4">
                        <div class="d-table mb-2">
                        <h4  style="font-family: 'Josefin Sans', sans-serif; font-weight: 300; display: table" class="m-0 p-0" >Datos mascota: <hr size="4" style="border: none; margin-top: 10px; width: 85%" class="mb-0"></h4><br>
                        </div>
                                <div class="w-100 d-flex justify-content-between align-items-center">
                                <h5 style="font-weight: 400 !important; font-size: 0.9rem;">Especie: ${Ver_Citas.Especie}</h5>
                                <h5 style="font-weight: 400 !important; font-size: 0.9rem;">Edad: ${Ver_Citas.edad_mascota}</h5>
                                <h5 style="font-weight: 400 !important; font-size: 0.9rem;">Nombre: ${Ver_Citas.Nombre_msc}</h5>
                                </div>
                            </div>
                            <div class="d-table">
                            <h4 style="font-family: 'Josefin Sans', sans-serif; font-weight: 300; width: auto" class="mt-4 mb-4">Cituacion descripcion:<hr size="4" style="border: none; margin-top: 10px; width: 85%"></h4>
                            </div>
                            <div class="d-flex justify-content-between align-items-start">                                              
                      <p style="font-weight: 400 !important; font-size: 0.9rem; text-align: justify;" class="mt-0 mb-0">${Ver_Citas.Cituacion}</p>
                      <img src="IMG/Animal.jpg" width="20%" height="auto" alt="Foto_Ver" class="ms-3">
                        </div>
                        <div class="d-flex justify-content-between align-items-start flex-column">
                            <div class="d-flex justify-content-start align-items-center flex-wrap; w-100 pb-2 pt-3">
                              <h5 style="font-weight: 400 !important; font-size: 0.9rem;">Estado: ${Stadde}</h5>
                                <h5 style="font-weight: 400 !important; font-size: 0.9rem;" class="ms-4 ps-2">Fech. Cita: ${Ver_Citas.Fecha_Cita}</h5>
                            </div>
                          </div>

                          
                          <div class="d-flex justify-content-center align-items-start flex-column flex-wrap pt-3 mt-3 mb-3">
                            
                          <h4 style="font-family: 'Josefin Sans', sans-serif; font-weight: 300;" class="mb-0">Datos personales:<hr size="4" style="border: none; margin-top: 10px; width: 85%"></h4>
                          
                            <div class="w-100 d-flex justify-content-evenly mt-3">
                            <h5 style="font-weight: 400 !important; font-size: 0.9rem;" class="pe-4"> Telefono: ${Ver_Citas.Telefono}</h5>
                            <h5 style="font-weight: 400 !important; font-size: 0.9rem;" class="ps-4"> Direccion: ${Ver_Citas.direccion}</h5>
                            </div>
                            <div class="w-100 d-flex justify-content-evenly pb-2 mt-4">
                            <h5 style="font-weight: 400 !important; font-size: 0.9rem;" class="pe-4"> Usuario: ${Ver_Citas.Usuario}</h5>
                            <h5 style="font-weight: 400 !important; font-size: 0.9rem;" class="ps-4"> Contraseña: ${Ver_Citas.contraseña}</h5>
                            </div>
                        </div>

                      </div>                
            </div>
          </div>          
        </div>
        ` 
        $('#Activar_Visor_Adm').click()
      
        
  }



    

    





    document.getElementById("Selector_Options").addEventListener('change', (e) =>{
      
            
      var Valor_Cambio = e.target.value
      if(Valor_Cambio == "Citas pendientes"){              
        //Inicio
        var Imprimir = ""
        document.getElementById("Tabla_Admin").innerHTML = ""        
            
            Addjuntar_Element()
            Tablas("Pendiente")                                                  

              Eliminar_Alertas()
              if(Cantidad_V == 0){                        
                document.getElementById("Sin_Pendientes").style.display = ""                        
              }

          }
        //Fin
      
        //Inicio
      if(Valor_Cambio == "Citas activas"){ 
            document.getElementById("Tabla_Admin").innerHTML = ""   
            var Imprimir = ""
            
                 
                  Tablas("Activo")
                  Addjuntar_Element()         
                                
                  
              Eliminar_Alertas()
              if(Cantidad_V == 0){                    
                document.getElementById("Sin_Activos").style.display = ""                             
              }
      }
      //Final
      if(Valor_Cambio == "Citas inactivas"){
            document.getElementById("Tabla_Admin").innerHTML = ""
            var Imprimir = ""
                    

            Tablas("Inactivo")
            Addjuntar_Element()                                      
            
            
              Eliminar_Alertas()
              if(Cantidad_V == 0){
              document.getElementById("Sin_Inactivos").style.display = "block"                                                  
              }

        //Fin 
      }
      //Inicio
      if(Valor_Cambio == "Todas las citas"){
            document.getElementById("Tabla_Admin").innerHTML = ""
            var Contrar_Todo = 0
            var Imprimir = ""
                    
            Tabla_Completa()
            Addjuntar_Element()  
                                             
                      
           Eliminar_Alertas()
           if(Cantidad_V == 0){
              document.getElementById("Sin_Registros").style.display = ""
            }
          }      
    
      }
    )


    $('#Buscar_Citas_Adm').keypress(function(e) {
    var keycode = (e.keyCode ? e.keyCode : e.which);
    if (keycode == '13') {
      Busqueda_Admin();
        } 
    });


    function Busqueda_Admin() {
      if(Cantidad_V != 0){
      var Borrar_Todo = true

      var All_Dato_Cont = document.getElementsByTagName("tr")   
      var Dato = document.getElementById("Buscar_Citas_Adm").value.toUpperCase()

      for(var a = 1; a < All_Dato_Cont.length; a++){             
          var Contenedor = All_Dato_Cont[a]
          var All_Dato = Contenedor.getElementsByTagName("td")
          var Elemento_Id = Contenedor.getAttribute("id")
          var Borrar = true      

            for(var i= 0; i < All_Dato.length; i++){
                var elemento = All_Dato[i]
                var Valor = elemento.textContent || elemento.innerText;
                if(Valor.toUpperCase().indexOf(Dato) > -1){                                     
                    Borrar_Todo = false
                    document.getElementById(Elemento_Id).style.display = ""
                    Borrar = false
                }else{
                    if(Borrar == true){
                    document.getElementById(Elemento_Id).style.display = "none"
                      }
                    } 
                  }
                }
        if(Borrar_Todo == true){
            document.getElementById("Error_Admin_BSQ").style.display = "block"
        }else{
            document.getElementById("Error_Admin_BSQ").style.display = "none"
        }
 

    }else{
      Swal.fire({
        position: 'center',
        icon: 'error',
        title: 'No hay ningun dato disponible',
        text:  `No se puede usar el buscador, ya que no hay ningun dato registrado en la tabla, para poder buscarlo.`,
        showConfirmButton: true,
        confirmButtonText: "Continuar"
      })
    }

  }




</script>
</body>